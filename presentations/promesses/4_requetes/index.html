<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Promesse : des requettes</title>
    <style>
        #result {
            background-color: #dfd;
            width: 80%;
            padding: 1rem;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }
    </style>
</head>

<body>

    <h1>Promesses multiples</h1>

    <p>Les promesses s'affichent une fois la réponse obtenue.</p>
    <p>L'ordre d'affichage n'est pas geré.</p>
    <div id="result"></div>
    <script>

        /* function pour durée aléatoire */
        alea = () => Math.random() * 2000

        /* creation et affichage d'un paragraphe dans le body */
        const afficheParagraphe = (text) => {
            const p = document.createElement('p')
            p.innerHTML = text
            document.querySelector('#result').append(p)
        }

        new Promise(resolve => setTimeout(() => resolve(1), alea()))
        .then(resp => afficheParagraphe(`promesse ${resp}`))

        new Promise(
            // resolve => setTimeout(() => resolve(2), alea())
            reject=> setTimeout(() => reject("erreur 2"), alea())
        )
        .then(resp => afficheParagraphe(`promesse ${resp}`))

        new Promise(            
            resolve => setTimeout(() => resolve(3), alea())
        )
        .then(resp => afficheParagraphe(`promesse ${resp}`))
        .catch(err => afficheParagraphe(err))


        // /* une promesse resolue */
        // const promesseOk = function (num) {
        //     return new Promise((resolve, reject) => {
        //         resolve(setTimeout((num) => resolve(num), alea(100)))
        //     }
        //     )
        // }
        // /* une promesse rejetée */
        // const prmesseFail = function (num) {
        //     return new Promise((resolve, reject) => {
        //         reject(`erreur promesse ${num}`)
        //     }
        //     )
        // }


        // Promise.all([
        //     promesseOk(1),
        //     promesseOk(2),
        //     // prmesseFail(2),
        //     promesseOk(3)
        // ])
        //     .then(resp => console.log(`promesse ${resp}`))
        //     .catch(err => console.log(err))


    </script>



</body>

</html>